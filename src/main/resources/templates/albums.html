<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Albums - Spotify</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Circular', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: linear-gradient(180deg, #121212 0%, #000000 100%);
            color: #ffffff;
            min-height: 100vh;
        }

        .container {
            display: flex;
            height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            width: 230px;
            background-color: #000000;
            padding: 24px 12px;
            display: flex;
            flex-direction: column;
            gap: 24px;
        }

        .logo {
            font-size: 28px;
            font-weight: 700;
            padding: 0 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .logo svg {
            width: 32px;
            height: 32px;
            fill: #ffffff;
        }

        .nav-menu {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 16px;
            padding: 12px;
            color: #b3b3b3;
            text-decoration: none;
            border-radius: 4px;
            transition: color 0.2s;
            font-size: 14px;
            font-weight: 700;
        }

        .nav-item:hover {
            color: #ffffff;
        }

        .nav-item.active {
            color: #ffffff;
            background-color: #282828;
        }

        .nav-icon {
            width: 24px;
            height: 24px;
            fill: currentColor;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            background: linear-gradient(180deg, #1e3a5f 0%, #121212 300px);
            overflow-y: auto;
            padding: 16px 32px 32px;
        }

        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 32px;
            padding-top: 8px;
        }

        .nav-buttons {
            display: flex;
            gap: 16px;
        }

        .nav-btn {
            background-color: rgba(0, 0, 0, 0.7);
            border: none;
            border-radius: 50%;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: #ffffff;
        }

        .search-bar {
            display: flex;
            align-items: center;
            background-color: #ffffff;
            border-radius: 500px;
            padding: 8px 16px;
            width: 364px;
        }

        .search-bar input {
            border: none;
            background: none;
            outline: none;
            width: 100%;
            font-size: 14px;
            color: #000000;
        }

        .search-bar input::placeholder {
            color: #757575;
        }

        /* User Profile */
        .user-profile {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .user-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: linear-gradient(135deg, #1db954, #1ed760);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: 700;
            color: #000;
            cursor: pointer;
        }

        .user-dropdown {
            position: relative;
        }

        .user-menu {
            position: absolute;
            top: 100%;
            right: 0;
            margin-top: 8px;
            background-color: #282828;
            border-radius: 4px;
            padding: 4px;
            min-width: 160px;
            box-shadow: 0 16px 24px rgba(0,0,0,0.3);
            display: none;
            z-index: 1000;
        }

        .user-dropdown:hover .user-menu {
            display: block;
        }

        .user-menu-item {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            color: #ffffff;
            text-decoration: none;
            border-radius: 2px;
            font-size: 14px;
            transition: background-color 0.2s;
        }

        .user-menu-item:hover {
            background-color: #3e3e3e;
        }

        .auth-buttons {
            display: flex;
            gap: 16px;
        }

        .auth-btn {
            padding: 8px 24px;
            border-radius: 500px;
            border: none;
            font-weight: 700;
            cursor: pointer;
            text-decoration: none;
            display: inline-block;
            transition: all 0.2s;
            font-size: 14px;
        }

        .btn-login {
            background-color: transparent;
            color: #fff;
            border: 1px solid #fff;
        }

        .btn-login:hover {
            transform: scale(1.04);
            border-color: #1db954;
            color: #1db954;
        }

        .btn-signup {
            background-color: #fff;
            color: #000;
        }

        .btn-signup:hover {
            transform: scale(1.04);
        }

        /* Section */
        .section {
            margin-bottom: 40px;
        }

        .section-title {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 24px;
        }

        /* Grid */
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 24px;
        }

        .card {
            background-color: #181818;
            padding: 16px;
            border-radius: 8px;
            transition: background-color 0.3s;
            cursor: pointer;
            text-decoration: none;
            color: inherit;
            display: block;
            position: relative;
        }

        .card:hover {
            background-color: #282828;
        }

        .card:hover .play-btn {
            opacity: 1;
            transform: translateY(0);
        }

        .card-image-wrapper {
            position: relative;
            width: 100%;
            aspect-ratio: 1;
            margin-bottom: 16px;
        }

        .card-image {
            width: 100%;
            height: 100%;
            border-radius: 4px;
            object-fit: cover;
            background-color: #333;
        }

        .play-btn {
            position: absolute;
            bottom: 8px;
            right: 8px;
            width: 48px;
            height: 48px;
            background-color: #1db954;
            border: none;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            opacity: 0;
            transform: translateY(8px);
            transition: all 0.3s;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
        }

        .play-btn:hover {
            background-color: #1ed760;
            transform: translateY(0) scale(1.05);
        }

        .play-btn svg {
            width: 20px;
            height: 20px;
            fill: #000;
            margin-left: 2px;
        }

        .card-title {
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 8px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .card-subtitle {
            font-size: 14px;
            color: #b3b3b3;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .card-info {
            font-size: 13px;
            color: #b3b3b3;
            margin-top: 4px;
        }

        .no-results {
            text-align: center;
            padding: 60px 20px;
            color: #b3b3b3;
        }

        .no-results h3 {
            font-size: 24px;
            margin-bottom: 12px;
            color: #ffffff;
        }

        /* Song list styles (for search results) */
        .song-list-header {
            display: grid;
            grid-template-columns: 40px 1fr 200px 100px 80px;
            gap: 16px;
            padding: 8px 16px;
            border-bottom: 1px solid #282828;
            margin-bottom: 16px;
            color: #b3b3b3;
            font-size: 14px;
        }

        .song-list { display: flex; flex-direction: column; }
        .song-item {
            display: grid;
            grid-template-columns: 40px 1fr 200px 100px 80px;
            align-items: center;
            padding: 8px 16px;
            border-radius: 4px;
            transition: background-color 0.2s;
            gap: 16px;
            cursor: pointer;
        }
        .song-item:hover { background-color: #282828; }
        .song-number { text-align: center; color: #b3b3b3; font-size: 16px; }
        .song-info { display: flex; gap: 12px; align-items: center; min-width: 0; }
        .song-thumbnail { width: 40px; height: 40px; border-radius: 4px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); flex-shrink: 0; }
        .song-details { min-width: 0; flex: 1; }
        .song-title { font-size: 16px; color: #ffffff; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; margin-bottom: 4px; }
        .song-artist { font-size: 14px; color: #b3b3b3; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .song-album { color: #b3b3b3; font-size: 14px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; text-decoration: none; }
        .song-album:hover { color: #ffffff; text-decoration: underline; }
        .song-plays { color: #b3b3b3; font-size: 14px; text-align: center; }
        .song-duration { color: #b3b3b3; font-size: 14px; text-align: right; display: flex; align-items: center; justify-content: flex-end; gap: 16px; }

        @media (max-width: 768px) {
            .sidebar {
                width: 80px;
            }
            .nav-item span {
                display: none;
            }
            .grid {
                grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="logo">
                <svg viewBox="0 0 1134 340" xmlns="http://www.w3.org/2000/svg">
                    <path d="M8 171c0 92 76 168 168 168s168-76 168-168S268 4 176 4 8 79 8 171zm230 78c-39-24-89-30-147-17-14 2-16-18-4-20 64-15 118-8 162 19 11 7 0 24-11 18zm17-45c-45-28-114-36-167-20-17 5-23-21-7-25 61-18 136-9 188 23 14 9 0 31-14 22zM80 133c-17 6-28-23-9-30 59-18 159-15 221 22 17 9 1 37-17 27-54-32-144-35-195-19zm379 91c-17 0-33-6-47-20-1 0-1 1-1 1l-16 19c-1 1-1 2 0 3 18 16 40 24 64 24 34 0 55-19 55-47 0-24-15-37-50-46-29-7-34-12-34-22s10-16 23-16 25 5 39 15c0 0 1 1 2 1s1-1 1-1l14-20c1-1 1-1 0-2-16-13-35-20-56-20-31 0-53 19-53 46 0 29 20 38 52 46 28 6 32 12 32 22 0 11-10 17-25 17zm95-77v-13c0-1-1-2-2-2h-26c-1 0-2 1-2 2v147c0 1 1 2 2 2h26c1 0 2-1 2-2v-46c10 11 21 16 36 16 27 0 54-21 54-61s-27-60-54-60c-15 0-26 5-36 17zm30 78c-18 0-31-15-31-35s13-34 31-34 30 14 30 34-12 35-30 35zm68-34c0 34 27 60 62 60s62-27 62-61-26-60-61-60-63 27-63 61zm30-1c0-20 13-34 32-34s33 15 33 35-13 34-32 34-33-15-33-35zm140-58v-29c0-1 0-2-1-2h-26c-1 0-2 1-2 2v29h-13c-1 0-2 1-2 2v22c0 1 1 2 2 2h13v58c0 23 11 35 34 35 9 0 18-2 25-6 1 0 1-1 1-2v-21c0-1 0-2-1-2h-2c-5 3-11 4-16 4-8 0-12-4-12-12v-54h30c1 0 2-1 2-2v-22c0-1-1-2-2-2h-30zm129-3c0-11 4-15 13-15 5 0 10 0 15 2h1s1-1 1-2V93c0-1 0-2-1-2-5-2-12-3-22-3-24 0-36 14-36 39v5h-13c-1 0-2 1-2 2v22c0 1 1 2 2 2h13v89c0 1 1 2 2 2h26c1 0 1-1 1-2v-89h25l37 89c-4 9-8 11-14 11-5 0-10-1-15-4h-1l-1 1-9 19c0 1 0 3 1 3 9 5 17 7 27 7 19 0 30-9 39-33l45-116v-2c0-1-1-1-2-1h-27c-1 0-1 1-1 1l-28 78-30-78c0-1-1-1-2-1h-44v-3zm-83 3c-1 0-2 1-2 2v113c0 1 1 2 2 2h26c1 0 1-1 1-2V134c0-1 0-2-1-2h-26zm-6-33c0 10 9 19 19 19s18-9 18-19-8-18-18-18-19 8-19 18zm245 69c10 0 19-8 19-18s-9-18-19-18-18 8-18 18 8 18 18 18zm0-34c9 0 17 7 17 16s-8 16-17 16-16-7-16-16 7-16 16-16zm4 18c3-1 5-3 5-6 0-4-4-6-8-6h-8v19h4v-6h4l4 6h5zm-3-9c2 0 4 1 4 3s-2 3-4 3h-4v-6h4z"/>
                </svg>
            </div>

            <nav class="nav-menu">
                <a href="/" class="nav-item">
                    <svg class="nav-icon" viewBox="0 0 512 512">
                        <path d="M261.56 101.28a8 8 0 00-11.06 0L66.4 277.15a8 8 0 00-2.47 5.79L63.9 448a32 32 0 0032 32H192a16 16 0 0016-16V328a8 8 0 018-8h80a8 8 0 018 8v136a16 16 0 0016 16h96.06a32 32 0 0032-32V282.94a8 8 0 00-2.47-5.79z"/>
                        <path d="M490.91 244.15l-74.8-71.56V64a16 16 0 00-16-16h-48a16 16 0 00-16 16v32l-57.92-55.38C272.77 35.14 264.71 32 256 32c-8.68 0-16.72 3.14-22.14 8.63l-212.7 203.5c-6.22 6-7 15.87-1.34 22.37A16 16 0 0043 267.56L250.5 69.28a8 8 0 0111.06 0l207.52 198.28a16 16 0 0022.59-.44c6.14-6.36 5.63-16.86-.76-22.97z"/>
                    </svg>
                    <span>Home</span>
                </a>
                <a href="/search?q=" class="nav-item">
                    <svg class="nav-icon" viewBox="0 0 512 512">
                        <path d="M221.09 64a157.09 157.09 0 10157.09 157.09A157.1 157.1 0 00221.09 64z" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="32"/>
                        <path fill="none" stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="32" d="M338.29 338.29L448 448"/>
                    </svg>
                    <span>Search</span>
                </a>
                <a href="/albums" class="nav-item active">
                    <svg class="nav-icon" viewBox="0 0 512 512">
                        <rect x="32" y="96" width="64" height="368" rx="16" ry="16" fill="currentColor"/>
                        <rect x="112" y="32" width="64" height="432" rx="16" ry="16" fill="currentColor"/>
                        <rect x="192" y="112" width="64" height="352" rx="16" ry="16" fill="currentColor"/>
                        <rect x="272" y="48" width="64" height="416" rx="16" ry="16" fill="currentColor"/>
                        <rect x="352" y="160" width="64" height="304" rx="16" ry="16" fill="currentColor"/>
                        <rect x="432" y="128" width="64" height="336" rx="16" ry="16" fill="currentColor"/>
                    </svg>
                    <span>Albums</span>
                </a>
                <a href="/songs" class="nav-item">
                    <svg class="nav-icon" viewBox="0 0 512 512">
                        <path d="M183.83 480a55.2 55.2 0 01-32.36-10.55A56.64 56.64 0 01128 423.58a50.26 50.26 0 014.62-27.73 47.74 47.74 0 0115.67-18.13c9.15-6.34 20.28-10.3 32-11.5a50.58 50.58 0 0112.76 0 54.76 54.76 0 0117.1 5.34A58.52 58.52 0 01232 392.08V146l176-53.84v196.34a50.26 50.26 0 014.62 27.73 56.64 56.64 0 01-23.47 45.87A55.2 55.2 0 01356.83 373a58.52 58.52 0 01-21.85-20.52 54.76 54.76 0 01-7.10-17.1 50.58 50.58 0 010-12.76c1.2-11.72 5.16-22.85 11.5-32a47.74 47.74 0 0118.13-15.67A50.26 50.26 0 01385.24 271a56.64 56.64 0 0145.87 23.47A55.2 55.2 0 01442 327.83V32l64 32v300.58a56.64 56.64 0 01-23.47 45.87A55.2 55.2 0 01450.17 421a58.52 58.52 0 01-21.85-20.52A54.76 54.76 0 01421.22 383a50.58 50.58 0 010-12.76c1.2-11.72 5.16-22.85 11.5-32a47.74 47.74 0 0118.13-15.67" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"/>
                    </svg>
                    <span>Songs</span>
                </a>
                <a href="/users" class="nav-item">
                    <svg class="nav-icon" viewBox="0 0 512 512">
                        <path d="M402 168c-2.93 40.67-33.1 72-66 72s-63.12-31.32-66-72c-3-42.31 26.37-72 66-72s69 30.46 66 72z" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"/>
                        <path d="M336 304c-65.17 0-127.84 32.37-143.54 95.41-2.08 8.34 3.15 16.59 11.72 16.59h263.65c8.57 0 13.77-8.25 11.72-16.59C463.85 335.36 401.18 304 336 304z" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="32"/>
                        <path d="M200 185.94c-2.34 32.48-26.72 58.06-53 58.06s-50.7-25.57-53-58.06C91.61 152.15 115.34 128 147 128s55.39 24.77 53 57.94z" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"/>
                        <path d="M206 306c-18.05-8.27-37.93-11.45-59-11.45-52 0-102.1 25.85-114.65 76.2-1.65 6.66 2.53 13.25 9.37 13.25H154" fill="none" stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="32"/>
                    </svg>
                    <span>Users</span>
                </a>
            </nav>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <div class="header">
                <div class="nav-buttons">
                    <button class="nav-btn" onclick="history.back()">←</button>
                    <button class="nav-btn" onclick="history.forward()">→</button>
                </div>

                <form action="/search" method="get" class="search-bar">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                        <path d="M7 12.5a5.5 5.5 0 100-11 5.5 5.5 0 000 11zM13.5 13.5l-3-3" stroke="#000" stroke-width="1.5" stroke-linecap="round"/>
                    </svg>
                    <input type="text" 
                           name="q" 
                           th:value="${searchQuery}" 
                           placeholder="Search albums and songs..." />
                </form>

                <!-- User Profile or Auth Buttons -->
                <div th:if="${loggedInUser != null}" class="user-profile">
                    <div class="user-dropdown">
                        <div class="user-avatar" th:text="${#strings.substring(loggedInUser.username, 0, 1).toUpperCase()}">U</div>
                        <div class="user-menu">
                            <a href="/users" class="user-menu-item">
                                <span th:text="${loggedInUser.username}">Username</span>
                            </a>
                            <a href="/users/logout" class="user-menu-item">Logout</a>
                        </div>
                    </div>
                </div>
                <div th:if="${loggedInUser == null}" class="auth-buttons">
                    <a href="/users/login" class="auth-btn btn-login">Log in</a>
                    <a href="/users/register" class="auth-btn btn-signup">Sign up</a>
                </div>
            </div>

            <section class="section">
                <h1 class="section-title" th:text="${searchQuery != null ? 'Search results for ' + searchQuery : 'All Albums'}">All Albums</h1>

                <!-- Default view: All albums -->
                <div th:if="${searchQuery == null}">
                    <div th:if="${#lists.isEmpty(albums)}" class="no-results">
                        <h3>No albums found</h3>
                        <p>Try searching with different keywords</p>
                    </div>
                    <div th:unless="${#lists.isEmpty(albums)}" class="grid">
                        <a th:each="album : ${albums}" 
                           th:href="@{/album/{id}(id=${album.id})}" 
                           class="card">
                            <div class="card-image-wrapper">
                                <img th:src="${album.imageUrl}" 
                                     th:alt="${album.name}" 
                                     class="card-image"
                                     onerror="this.src='https://via.placeholder.com/300x300/333/fff?text=Album'">
                                <button class="play-btn">
                                    <svg viewBox="0 0 16 16">
                                        <path d="M3 1.713a.7.7 0 011.05-.607l10.89 6.288a.7.7 0 010 1.212L4.05 14.894A.7.7 0 013 14.288V1.713z"/>
                                    </svg>
                                </button>
                            </div>
                            <div class="card-title" th:text="${album.name}">Album Name</div>
                            <div class="card-subtitle" th:text="${album.artist + ' • ' + album.releaseYear}">Artist Name • Year</div>
                            <div class="card-info" th:text="${#numbers.formatInteger(album.followers, 3, 'COMMA') + ' followers'}">0 followers</div>
                        </a>
                    </div>
                </div>

                <!-- Search results: show albums and songs sections separately -->
                <div th:if="${searchQuery != null}">
                    <div th:if="${#lists.isEmpty(albums) and #lists.isEmpty(songs)}" class="no-results">
                        <h3>No results found</h3>
                        <p>Try searching with different keywords</p>
                    </div>

                    <!-- Albums section -->
                    <div th:unless="${#lists.isEmpty(albums)}" style="margin-top: 16px;">
                        <h2 class="section-title" style="font-size:24px;">Albums</h2>
                        <div class="grid">
                            <a th:each="album : ${albums}" 
                               th:href="@{/album/{id}(id=${album.id})}" 
                               class="card">
                                <div class="card-image-wrapper">
                                    <img th:src="${album.imageUrl}" 
                                         th:alt="${album.name}" 
                                         class="card-image"
                                         onerror="this.src='https://via.placeholder.com/300x300/333/fff?text=Album'">
                                    <button class="play-btn">
                                        <svg viewBox="0 0 16 16">
                                            <path d="M3 1.713a.7.7 0 011.05-.607l10.89 6.288a.7.7 0 010 1.212L4.05 14.894A.7.7 0 013 14.288V1.713z"/>
                                        </svg>
                                    </button>
                                </div>
                                <div class="card-title" th:text="${album.name}">Album Name</div>
                                <div class="card-subtitle" th:text="${album.artist + ' • ' + album.releaseYear}">Artist Name • Year</div>
                                <div class="card-info" th:text="${#numbers.formatInteger(album.followers, 3, 'COMMA') + ' followers'}">0 followers</div>
                            </a>
                        </div>
                    </div>

                    <!-- Songs section -->
                    <div th:unless="${#lists.isEmpty(songs)}" style="margin-top: 32px;">
                        <h2 class="section-title" style="font-size:24px;">Songs</h2>
                        <div class="song-list-header">
                            <div>#</div>
                            <div>Title</div>
                            <div>Album</div>
                            <div style="text-align:center;">Plays</div>
                            <div style="text-align:right;">Duration</div>
                        </div>
                        <div class="song-list">
                            <div th:each="song, iterStat : ${songs}" class="song-item">
                                <div class="song-number" th:text="${iterStat.index + 1}">1</div>
                                <div class="song-info">
                                    <div class="song-thumbnail"></div>
                                    <div class="song-details">
                                        <div class="song-title" th:text="${song.title}">Song Title</div>
                                        <div class="song-artist" th:text="${song.artist}">Artist Name</div>
                                    </div>
                                </div>
                                <a th:href="@{/album/{id}(id=${song.albumId})}" class="song-album" th:text="${song.album}">Album Name</a>
                                <div class="song-plays" th:text="${#numbers.formatInteger(song.plays, 3, 'COMMA')}">0</div>
                                <div class="song-duration" th:text="${song.duration}">3:45</div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </div>
</body>
</html>
